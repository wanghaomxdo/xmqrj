var Data=function(){function t(){}var e=(__define,t);e.prototype;return t.getRectWidth=function(){return 0==t._rectWidth&&(t._rectWidth=egret.MainContext.instance.stage.stageWidth/4),t._rectWidth},t.getRectRow=function(){return 0==t._rectRow&&(t._rectRow=Math.ceil(egret.MainContext.instance.stage.stageHeight/t.getRectWidth())),t._rectWidth},t.getStageHeight=function(){return egret.MainContext.instance.stage.stageHeight},t._rectWidth=0,t.score=0,t._rectRow=0,t}();egret.registerClass(Data,"Data");var Game=function(){function t(t){this._root=t,this.createGroupsRect(),this.createTimer(),this.startGame()}var e=(__define,t),i=e.prototype;return i.createGroupsRect=function(){this._rectRoot=new egret.Sprite,this._root.addChild(this._rectRoot),this._rectGroups=[],this._row=Data.getRectRow();for(var t,e=0;e<this._row;e++)t=new GroupRect,t.addEventListener("gameOver",this.gameOver,this),t.addEventListener("clickRight",this.nextRow,this),this._rectGroups.push(t),t.y=Data.getRectWidth()*e,this._rectRoot.addChild(t);this._rectRoot.y=Data.getStageHeight()-this._rectRoot.height},i.gameOver=function(){this._timerPanel.stop(),this.gameOverPanel||(this.gameOverPanel=new GameOverPanel,this.gameOverPanel.addEventListener("startGame",this.initGame,this)),this._root.addChild(this.gameOverPanel)},i.nextRow=function(){this._timerPanel.num();for(var t=0;t<this._row;t++){egret.Tween.get(this._rectGroups[t]).to({y:this._rectGroups[t].y+120},200);this._rectGroups[t].move()}Data.score++},i.createTimer=function(){this._timerPanel=new TimerPanel,this._timerPanel.addEventListener("gameOver",this.gameOver,this),this._root.addChild(this._timerPanel)},i.initGame=function(){this._timerPanel.start(),this._timerPanel.num1(),Data.score=0,this._root.removeChild(this._rectRoot),this.createGroupsRect(),this.createTimer(),this.startGame()},i.startGame=function(){for(var t=0;t<this._row;t++)t!=this._row-1&&(this._rectGroups[t].y=Data.getRectWidth()*t,this._rectGroups[t]._currentRow=t,this._rectGroups[t].createBlackRect());this._timerPanel.start()},t}();egret.registerClass(Game,"Game");var GameOverPanel=function(t){function e(){t.call(this),this.draw(),this.addEventListener(egret.Event.ADDED,this.showText,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.draw=function(){var t=Data.getStageHeight(),e=egret.MainContext.instance.stage.stageWidth;this.graphics.beginFill(1118481,1),this.graphics.drawRect(0,0,e,t),this.graphics.endFill(),this._GameOverPanelS=new GameOverPanelS(this,RES.getRes("game_json")),this.txt=new egret.TextField,this.txt.width=e,this.txt.y=100,this.txt.textColor=16711680,this.txt.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txt);var e=egret.MainContext.instance.stage.stageWidth,t=egret.MainContext.instance.stage.stageHeight,i=this.createBitmapByName("game_json.againbt1"),r=this.createBitmapByName("game_json.share1");i.x=(e-i.width)/2,r.x=(e-r.width)/2,i.y=t-2*i.height-30,r.y=t-r.height-25,this.addChild(r),this.addChild(i),r.touchEnabled=!0,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareGame,this)},r.retunsGame=function(){window.location.href="/index.php?action=jingpinyxIn"},r.showText=function(){this.txt.text="你摁死了"+Data.score+"对情侣。\n真是太厉害啦。\n继续狂欢吧！"},r.startGame=function(){this.parent.removeChild(this),Data.score=1,this.dispatchEventWith("startGame")},r.shareGame=function(){this._ShallGamePanel=new ShallGamePanel(this,RES.getRes("game_json"))},r.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);egret.registerClass(GameOverPanel,"GameOverPanel");var GroupRect=function(t){function e(){t.call(this),this._currentBlackRectIndex=0,this._currentWhiteRectIndex=0,this._currentRow=0,this.createRects()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.createRects=function(){this._rects=[];for(var t=0;4>t;t++){var e=new Rect;this._rects.push(e),e.x=e.width*t,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickRect,this)}},r.onClickRect=function(t){this._currentRow==Data.getRectRow()-2&&(t.target.onRectClick(),t.target.type==RectType.NONCLICKABLE?this.dispatchEventWith("gameOver"):this.dispatchEventWith("clickRight"))},r.createBlackRect=function(){var t=Math.random();t>=0&&.25>t?this._currentBlackRectIndex=0:t>=.25&&.5>t?this._currentBlackRectIndex=1:t>=.5&&.75>t?this._currentBlackRectIndex=2:this._currentBlackRectIndex=3,this._rects[this._currentBlackRectIndex].type=RectType.CLICKABLE;var e=this._currentBlackRectIndex;0==Math.floor(3*Math.random())&&(3==e?this._rects[e-Math.floor(3*Math.random()+1)].type=RectType.NONCLICKABLE:0==e?this._rects[e+Math.floor(3*Math.random()+1)].type=RectType.NONCLICKABLE:1==e?this._rects[e+Math.floor(2*Math.random()+1)].type=RectType.NONCLICKABLE:this._rects[e-Math.floor(2*Math.random()+1)].type=RectType.NONCLICKABLE)},r.init=function(){for(var t=0;4>t;t++)this._rects[t].type=RectType.NONCLICKABLE},r.move=function(){this._currentRow++,this._currentRow==Data.getRectRow()&&(this._currentRow=0),this.y=this._currentRow*Data.getRectWidth()},e}(egret.Sprite);egret.registerClass(GroupRect,"GroupRect");var Rect=function(t){function e(){t.call(this),this._colors=[0,16777215,16711680,255],this._currentColor=1,this._type=RectType.NONCLICKABLE,this.touchEnabled=!0,this.draw()}__extends(e,t);var i=__define,r=e,s=r.prototype;return s.draw=function(){this.width=Data.getRectWidth(),this.height=Data.getRectWidth(),this.graphics.drawRect(0,0,this.width,this.height),this.graphics.endFill()},i(s,"type",function(){return this._type},function(t){this._type=t,this._type==RectType.CLICKABLE?this._BlackUI=new BlackUI(this,RES.getRes("game_json")):this._type==RectType.NONCLICKABLE&&(this._WhiteUI=new WhitUI(this,RES.getRes("game_json"))),this.draw()}),s.onRectClick=function(){this._type==RectType.CLICKABLE?(this.removeChild(this._BlackUI),this._TrueUI=new TrueUI(this,RES.getRes("game_json"))):this._type==RectType.NONCLICKABLE&&(this.removeChild(this._WhiteUI),this._TrueUI=new TrueUI(this,RES.getRes("game_json"))),this.draw()},e}(egret.Sprite);egret.registerClass(Rect,"Rect");var RectType=function(){function t(){}var e=(__define,t);e.prototype;return t.CLICKABLE="clickable",t.NONCLICKABLE="nonclickable",t}();egret.registerClass(RectType,"RectType");var TimerPanel=function(t){function e(){t.call(this),this._num=20,this._timers=20,this._numb=0,this.draw(),this.createTimer()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.draw=function(){var t=egret.MainContext.instance.stage.stageWidth;this.graphics.beginFill(0),this.graphics.drawRect(0,0,t,60),this.graphics.endFill(),this._TitleUI=new TitleUI(this,RES.getRes("game_json")),this._PhotoUI=new PhotoUI(this,RES.getRes("game_json")),this.txt=new egret.TextField,this.txt.y=20,this.txt.x=t-200,this.txt.textColor=16711680,this.txt.text="20'00''",this.addChild(this.txt),this.txt1=new egret.TextField,this.txt1.x=120,this.txt1.y=20,this.txt1.textColor=16711680,this.txt1.text=" = 0",this.addChild(this.txt1)},r.createTimer=function(){this._timer=new egret.Timer(1e3,this._num),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimercom,this)},r.onTimer=function(){this._timers-=1,this.txt.text=this._timers+"'00''"},r.num=function(){this._numb+=1,this.txt1.text=" = "+this._numb},r.num1=function(){this._numb=0,this.txt1.text=" = 0"},r.onTimercom=function(){this.txt.text="00'00''",this.dispatchEventWith("gameOver")},r.start=function(){this.txt.text="20'00''",this._timers=20,this._timer.reset(),this._timer.start()},r.stop=function(){this._timer.stop()},e}(egret.Sprite);egret.registerClass(TimerPanel,"TimerPanel");var BackGroundPanel=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth,s=egret.MainContext.instance.stage.stageHeight;this.texture=i.getTexture("game_bg"),this.width=r,this.height=s,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(BackGroundPanel,"BackGroundPanel");var BlackUI=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth,s=["0","1","2","3"],n=Math.floor(Math.random()*s.length+1)-1,a="lovers_"+n;this.texture=i.getTexture(a),this.width=r/4,this.height=r/4,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(BlackUI,"BlackUI");var GameOverPanelS=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth,s=egret.MainContext.instance.stage.stageHeight;this.texture=i.getTexture("score_bg"),this.width=r,this.height=s,e.addChild(this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.morGame=function(){window.location.href="http://7online.sinaapp.com/index.php"},e}(egret.Bitmap);egret.registerClass(GameOverPanelS,"GameOverPanelS");var PhotoUI=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth;this.texture=i.getTexture("photo_bg"),this.width=90,this.height=60,this.y=0,this.x=r-90,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(PhotoUI,"PhotoUI");var ShallGamePanel=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth;this.texture=i.getTexture("share"),this.width=r,this.x=0,this.y=0,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),e.addChild(this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.startGame=function(){this.parent.removeChild(this)},e}(egret.Bitmap);egret.registerClass(ShallGamePanel,"ShallGamePanel");var startUI=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth,s=egret.MainContext.instance.stage.stageHeight;this.texture=i.getTexture("star_page"),this.width=r,this.height=s,e.addChild(this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Bitmap);egret.registerClass(startUI,"startUI");var TitleUI=function(t){function e(e,i){t.call(this);egret.MainContext.instance.stage.stageWidth;this.texture=i.getTexture("title_bg"),this.width=70,this.height=50,this.y=5,this.x=50,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(TitleUI,"TitleUI");var TrueUI=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth;this.texture=i.getTexture("blood"),this.width=r/4,this.height=r/6,this.y=30,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(TrueUI,"TrueUI");var WhitUI=function(t){function e(e,i){t.call(this);var r=egret.MainContext.instance.stage.stageWidth,s=["0","1","2","3"],n=Math.floor(Math.random()*s.length+1)-1,a="single_"+n;this.texture=i.getTexture(a),this.height=r/4,this.width=r/5.5,e.addChild(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Bitmap);egret.registerClass(WhitUI,"WhitUI");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},r.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},r.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},r.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},r.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},r.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},r.createGameScene=function(){this._startUI=new startUI(this,RES.getRes("game_json")),this.txt=this.createBitmapByName("game_json.starbt1");var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this.txt.y=.85*e,this.txt.x=(t-t/2)/2,this.txt.width=t/2,this.addChild(this.txt),this.txt.touchEnabled=!0,this.txt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},r.startGame=function(){this.txt.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.removeChild(this.txt),this._BackGroundPanel=new BackGroundPanel(this,RES.getRes("game_json"));new Game(this)},r.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");